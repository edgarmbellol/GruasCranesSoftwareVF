{% extends "base.html" %}

{% block title %}Formulario Pendiente - Sistema de Grúas{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <!-- Header con advertencia -->
            <div class="text-center mb-4">
                <div class="alert alert-warning shadow-sm" role="alert">
                    <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
                    <h3 class="alert-heading">¡Formulario de Salida Pendiente!</h3>
                    <p class="mb-0">Tienes un registro de entrada activo que requiere completar la salida.</p>
                </div>
            </div>

            <!-- Información del equipo -->
            <div class="card shadow-sm">
                <div class="card-header bg-warning text-dark">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-crane me-2"></i>Equipo Asignado
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="info-item">
                                <i class="fas fa-tag text-primary me-2"></i>
                                <strong>Placa:</strong> {{ equipo_actual.Placa }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-item">
                                <i class="fas fa-cog text-primary me-2"></i>
                                <strong>Tipo:</strong> {{ equipo_actual.tipo_equipo.descripcion if equipo_actual.tipo_equipo else 'N/A' }}
                            </div>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-6">
                            <div class="info-item">
                                <i class="fas fa-tag text-primary me-2"></i>
                                <strong>Marca:</strong> {{ equipo_actual.marca.DescripcionMarca if equipo_actual.marca else 'N/A' }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-item">
                                <i class="fas fa-weight-hanging text-primary me-2"></i>
                                <strong>Capacidad:</strong> {{ equipo_actual.Capacidad }} T
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Información del empleado -->
            <div class="card shadow-sm mt-3">
                <div class="card-header bg-info text-white">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-user me-2"></i>Información del Empleado
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="info-item">
                                <i class="fas fa-id-card text-info me-2"></i>
                                <strong>Nombre:</strong> {{ empleado.nombre }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-item">
                                <i class="fas fa-hashtag text-info me-2"></i>
                                <strong>Documento:</strong> {{ empleado.documento }}
                            </div>
                        </div>
                    </div>
                    {% if entrada_pendiente and entrada_pendiente.cargo %}
                    <div class="row mt-2">
                        <div class="col-md-6">
                            <div class="info-item">
                                <i class="fas fa-briefcase text-info me-2"></i>
                                <strong>Cargo:</strong> {{ entrada_pendiente.cargo.descripcionCargo }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-item">
                                <i class="fas fa-clock text-info me-2"></i>
                                <strong>Estado:</strong> <span class="badge bg-warning">Trabajando</span>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Información del registro de entrada -->
            {% if entrada_pendiente %}
            <div class="card shadow-sm mt-3">
                <div class="card-header bg-success text-white">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-sign-in-alt me-2"></i>Registro de Entrada
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="info-item">
                                <i class="fas fa-calendar text-success me-2"></i>
                                <strong>Fecha:</strong> {{ entrada_pendiente.FechaEmpleado.strftime('%d/%m/%Y') }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-item">
                                <i class="fas fa-clock text-success me-2"></i>
                                <strong>Hora:</strong> {{ entrada_pendiente.HoraEmpleado.strftime('%H:%M') }}
                            </div>
                        </div>
                    </div>
                    
                    {% if entrada_pendiente.Kilometraje %}
                    <div class="row mt-2">
                        <div class="col-md-6">
                            <div class="info-item">
                                <i class="fas fa-tachometer-alt text-success me-2"></i>
                                <strong>Kilometraje:</strong> {{ entrada_pendiente.Kilometraje }}
                            </div>
                        </div>
                        {% if entrada_pendiente.Horometro %}
                        <div class="col-md-6">
                            <div class="info-item">
                                <i class="fas fa-clock text-success me-2"></i>
                                <strong>Horómetro:</strong> {{ entrada_pendiente.Horometro }}
                            </div>
                        </div>
                        {% endif %}
                    </div>
                    {% endif %}

                    {% if entrada_pendiente.cliente %}
                    <div class="row mt-2">
                        <div class="col-12">
                            <div class="info-item">
                                <i class="fas fa-building text-success me-2"></i>
                                <strong>Cliente:</strong> {{ entrada_pendiente.cliente.NombreCliente }}
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    {% if entrada_pendiente.Observacion %}
                    <div class="row mt-2">
                        <div class="col-12">
                            <div class="info-item">
                                <i class="fas fa-comment text-success me-2"></i>
                                <strong>Observación:</strong> {{ entrada_pendiente.Observacion }}
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endif %}

            <!-- Botón de acción -->
            <div class="text-center mt-4">
                <a href="{{ url_for('registro_horas', equipo_id=equipo_actual.IdEquipo) }}" 
                   class="btn btn-warning btn-lg">
                    <i class="fas fa-sign-out-alt me-2"></i>Completar Salida
                </a>
            </div>

            <!-- Información adicional -->
            <div class="alert alert-info mt-4" role="alert">
                <i class="fas fa-info-circle me-2"></i>
                <strong>Importante:</strong> Debes completar el registro de salida en el equipo {{ equipo_actual.Placa }} antes de poder trabajar en cualquier otro equipo. Esto es necesario para mantener un control preciso de las horas de trabajo.
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
.info-item {
    margin-bottom: 0.5rem;
    font-size: 0.95rem;
}

.info-item i {
    width: 20px;
    text-align: center;
}

.card {
    border: none;
    border-radius: 12px;
}

.card-header {
    border-radius: 12px 12px 0 0 !important;
    border: none;
}

.alert {
    border-radius: 12px;
    border: none;
}

.btn {
    border-radius: 8px;
    font-weight: 500;
}

.shadow-sm {
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075) !important;
}

@media (max-width: 768px) {
    .col-md-6 {
        margin-bottom: 0.5rem;
    }
}
</style>
{% endblock %}
